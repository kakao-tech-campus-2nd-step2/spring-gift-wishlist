# spring-gift-wishlist

### 작업 배경

- 회원 시스템을 도입하여 회원 별로 위시 리스트를 관리하는 기능을 추가하고자 함
- 로그인 기능과 인증 및 인가 기능의 구현 필요

<br/>
<br/>

### 구현 범위

1. ERD 작성, 회원 테이블 추가, 상품 테이블 리팩토링
2. 회원가입 기능
3. 로그인 기능
4. 위시 리스트에 대한 CRUD 요청을 할 때 액세스 토큰을 보내도록 하고, 서버에서는 검증 전처리 후 유효하면 해당 요청을 수행 및 응답하고, 유효하지 않다면 로그인 다시 요구하는 응답 보냄.
5. 관리자페이지 로그인 화면 만들고, 정해진 관리자 계정이 아니라면 로그인 실패. 정해져있는 관리자 계정과 일치하면 액세스 토큰 발급 및 로컬스토리지 저장. 매 CRUD 요청 시 로컬스토리지의 액세스 토큰 보냄. 없으면 없는 채로 보내고 요청(재로그인 요구 응답)
6. 인증 인가 도입에 따른 기존 코드 리팩토링

<br/>
<br/>

### 작업 방식

1. ERD : 회원 테이블의 이메일은 변경의 여지가 있으니 인조키를 pk로 설계
2. 회원가입 기능 : 회원 테이블에 레코드 추가, 중복 예외 처리 로직 추가(실패 시 실패 응답), 성공 시 성공 응답
3. 로그인 기능 : 회원의 이메일, 비밀번호를 body에 담아 post 요청 -> 서버에서 받아서 해당 회원 정보가 회원 테이블에 존재하는지 확인 후, 있으면 해당 회원 정보로 액세스 토큰 만들어서 발급 및 응답. 없으면 회원가입 요구 응답
4. 위시 리스트에 대한 CRUD 요청 : 헤더에 액세스 토큰을 담아서 보냄. 서버에서는 이걸 검증함. 유효하면 원래 하던 응답 그대로 보내고, 유효하지 않으면 에러 및 재로그인 요구 메시지 응답
5. 관리자페이지 : 로그인 폼 페이지 만들기. 폼으로 요청 보내고, 응답으로 액세스 토큰과 함께 성공 응답 받았으면(관리자 계정인 경우에만 성공) 엑세스 토큰을 로컬스토리지에 넣고 위시리스트 전체 조회 페이지로 이동
- 만약 실패 응답을 받았을 경우 재로그인 요구 alert와 함께 로그인 페이지 리다이렉트
- 위시리스트 CRUD 요청 시 로컬스토리지에 있는 액세스 토큰을 헤더에 담아 보냄. 만약 액세스 토큰이 없거나 만료된 경우 재로그인 응답 메시지
6. AdminController와 test 코드 리팩토링 (인증, 인가 로직 도입)

