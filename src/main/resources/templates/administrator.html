<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{/layout/baseLayout}">

  <th:block layout:fragment="content">
    <table>
      <tr>
<!--        <th></th>-->
        <th>ID</th>
        <th>Name</th>
        <th>Price</th>
        <th>Image</th>
        <th>Actions</th>
      </tr>
      <th:block th:each="product:${products}">
        <tr>
<!--          <td><input type="checkbox" name="product" /></td>-->
          <td th:text="${product.id}"></td>
          <td th:text="${product.name}"></td>
          <td th:text="${product.price}"></td>
          <td th:text="${product.imageUrl}"></td>
          <td>
            <div style="display: flex; justify-content: space-between;">
                <button class="btn btn-primary icon" data-toggle="modal" th:data-target="'#updateModal' + ${product.id}">
                  <i class="fa-solid fa-pen" style="color: #FFD43B;"></i>
                </button>
                <div class="modal fade" th:id="'updateModal' + ${product.id}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                  <div class="modal-dialog" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Add New Product</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                          <span aria-hidden="true">&times;</span>
                        </button>
                      </div>
                      <form th:action="@{/admin/update/{id}(id=${product.id})}" th:object="${productRequest}" th:method="put">
                        <div class="modal-body">
                          <label>Name
                            <input type="text" th:value="${product.name}" name="name" required="required">
                          </label>
                          <label>Price
                            <input type="text" th:value="${product.price}" name="price" required="required">
                          </label>
                          <label>Image Url
                            <input type="text" th:value="${product.imageUrl}" name="imageUrl">
                          </label>
                        </div>
                        <div class="modal-footer">
                          <button type="submit" class="btn btn-primary">Update</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              <form th:action="@{/admin/delete/{id}(id=${product.id})}" th:method="delete">
                <button class="icon">
                  <i class="fa-solid fa-trash" style="color: #ff0000;"></i>
                </button>
              </form>
            </div>
          </td>
        </tr>
      </th:block>
    </table>

    <th:block th:if="${errorMessage}">
      <script th:inline="javascript">
        /*<![CDATA[*/
        alert([[${errorMessage}]]);
        /*]]>*/
      </script>
    </th:block>
  </th:block>
</html>